<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>All About One Time Passwords | </title><meta name="Description" content="In this post, I will tell you all that you need to know about how those one time passwords that you receive in texts, emails, or authentication programs work."><meta property="og:title" content="All About One Time Passwords" />
<meta property="og:description" content="In this post, I will tell you all that you need to know about how those one time passwords that you receive in texts, emails, or authentication programs work." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/" />
<meta property="og:image" content="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/feature.jpg"/>
<meta property="article:published_time" content="2021-01-23T11:04:43-07:00" />
<meta property="article:modified_time" content="2021-01-23T13:29:44-07:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/feature.jpg"/>
<meta name="twitter:title" content="All About One Time Passwords"/>
<meta name="twitter:description" content="In this post, I will tell you all that you need to know about how those one time passwords that you receive in texts, emails, or authentication programs work."/>
<meta name="application-name" content="The Imaginary Road">
<meta name="apple-mobile-web-app-title" content="The Imaginary Road"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/" /><link rel="prev" href="https://www.michaelfcollins3.me/posts/2021/01/build-libgit2-for-ios-and-catalyst/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.055364f5be272caa092b0e6654c165828707f8ab971e2656383a6d6392bc345e.css" integrity="sha256-BVNk9b4nLKoJKw5mVMFlgocH&#43;KuXHiZWODptY5K8NF4="><link rel="stylesheet" href="/css/style.min.d36bcce4183431ca6ec4eaa86352036c12fb39f53ce0ea9c69077ebf04d28ab8.css" integrity="sha256-02vM5Bg0McpuxOqoY1IDbBL7OfU84OqcaQd&#43;vwTSirg="><link rel="stylesheet" href="/lib/fontawesome-free/all.min.876d023d9d10c97941b80c3b03e2a5b94631ff7a4af9cee5604a6a2d39718d84.css" integrity="sha256-h20CPZ0QyXlBuAw7A&#43;KluUYx/3pK&#43;c7lYEpqLTlxjYQ="><link rel="stylesheet" href="/lib/animate/animate.min.3c770e90f98eb21b0c042fafb49755af93306fbaf42e449524f94fae9fc83295.css" integrity="sha256-PHcOkPmOshsMBC&#43;vtJdVr5Mwb7r0LkSVJPlPrp/IMpU="><meta name="google-site-verification" content="VrH7LVgvAmCiD5vBXpJ61NdL4bUlGwGU-ynOhH-VUd8" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "All About One Time Passwords",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.michaelfcollins3.me\/posts\/2021\/01\/all-about-one-time-passwords\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/www.michaelfcollins3.me\/posts\/2021\/01\/all-about-one-time-passwords\/feature.jpg",
                            "width":  2400 ,
                            "height":  1350 
                        }],"genre": "posts","keywords": "HOTP, Password, TOTP","wordCount":  2838 ,
        "url": "https:\/\/www.michaelfcollins3.me\/posts\/2021\/01\/all-about-one-time-passwords\/","datePublished": "2021-01-23T11:04:43-07:00","dateModified": "2021-01-23T13:29:44-07:00","publisher": {
            "@type": "Organization",
            "name": "michael-collins"},"author": {
                "@type": "Person",
                "name": "michael-collins"
            },"description": "In this post, I will tell you all that you need to know about how those one time passwords that you receive in texts, emails, or authentication programs work."
    }
    </script><script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https:\/\/www.michaelfcollins3.me"
        },{
            "@type": "ListItem",
            "position": 2,
            "name": "Algorithms",
            "item": "https://www.michaelfcollins3.me/categories/algorithms/"
        },{
                "@type": "ListItem",
                "position": 3,
                "name": "All About One Time Passwords"
            }]
    }
</script><script type="text/javascript">
    var _iub = _iub || [];
    _iub.csConfiguration = {"enableCcpa":true,"ccpaAcknowledgeOnDisplay":true,"whitelabel":false,"lang":"en","siteId":1866497,"ccpaApplies":true,"cookiePolicyId":33791094, "banner":{ "acceptButtonDisplay":true,"customizeButtonDisplay":true,"position":"float-top-center" }};
</script>
<script type="text/javascript" src="//cdn.iubenda.com/cs/ccpa/stub.js"></script>
<script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async></script></head>
    <body data-header-desktop="" data-header-mobile=""><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="The Imaginary Road" class="header-logo">The Imaginary Road</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Blog </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="The Imaginary Road" class="header-logo">The Imaginary Road</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Blog</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header><main class="main"><div class="container content-article"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single page-toc theme-classic"><div class="post-all-meta  padding-article ">
                <div class="breadcrumbs">
    <a href="/">Home </a>/ <a href="/categories/algorithms/">Algorithms </a>/ <a href="/"> All About One Time Passwords </a>
</div>
                    <h1 class="single-title animated flipInX">All About One Time Passwords</h1><div class="post-meta">
                        <div class="post-meta-line"><span class="post-category">
                                <a href="/categories/algorithms/"><i class="far fa-folder fa-fw"></i>&nbsp;Algorithms</a>
                            </span>&nbsp;&nbsp;&nbsp;&nbsp;<i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time class="timeago" datetime="2021-01-23">January 23, 2021</time>&nbsp;&nbsp;&nbsp;&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2838 words
                            &nbsp;&nbsp;&nbsp;&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;14 minutes</div>
                    </div>
                </div><div class="post"><div class="image-theme-classic">
                <img src="/posts/2021/01/all-about-one-time-passwords/feature.jpg" style="width: 100%">
            </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#a-tale-of-two-rfcs">A Tale of Two RFCs</a></li>
    <li><a href="#a-quick-primer-on-cryptography">A Quick Primer on Cryptography</a></li>
    <li><a href="#hotp">HOTP</a></li>
    <li><a href="#totp">TOTP</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content" style="padding-top: 20px"><p>Two factor authentication is happening everywhere now. Corporate logins and many websites are now texting, emailing, or requiring you to enter a one time passcode in order to gain access. In this post, I will show you how these codes are being generated and how you can add them to your applications.</p>
<p>You are seeing this a lot lately. Most websites or corporate logins are starting to require more than just a username and password for authentication. You may be receiving a six or eight digit passcode via a text message, from an email, or using a tool such as 1Password or Google Authenticator to generate a temporary and time-limited passcode to prove your identity. This is called <strong>two-factor authentication</strong>, or <strong>2FA</strong>. Have you ever asked yourself where these codes come from? How do these companies generate and validate these codes? How do they work and are they secure? In this post, we&rsquo;ll dive into the algorithms and standards behind these passcodes to show you how they work and how you can use them with your own applications.</p>
<h2 id="a-tale-of-two-rfcs">A Tale of Two RFCs</h2>
<p>The passcodes that we talk about are technically considered one time passwords. The idea is that you use the password once and never use it again. Many of these passcodes are time sensitive. They may expire in 30 seconds or 15 minutes. But there&rsquo;s usually a time limit involved when using the passwords for online services.</p>
<p>There are two <a href="https://en.wikipedia.org/wiki/Request_for_Comments" target="_blank" rel="noopener noreffer">Internet RFCs</a> that provide the algorithms for implementing one time passwords:</p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc4226" target="_blank" rel="noopener noreffer">RFC 4226: HOTP: An HMAC-Based One-Time Password Algorithm</a></li>
<li><a href="https://tools.ietf.org/html/rfc6238" target="_blank" rel="noopener noreffer">RFC 6238: TOTP: Time-Based One-Time Password Algorithm</a></li>
</ul>
<p>HOTP is the base algorithm. HOTP works by using an incrementing counter. Every time a password is requested, a new password is generated based off of the new value of the counter. The same password cannot be reused more than once. TOTP is an application of HOTP and generates a counter using time. TOTP uses the concept of a time step, such as 30 seconds. The current time is matched to a time bucket with a counter value. The one time password is only valid within that same time bucket.</p>
<h2 id="a-quick-primer-on-cryptography">A Quick Primer on Cryptography</h2>
<p>I&rsquo;m going to stop quickly to provide a quick primer on the cryptography information that you need to know to understand these algorithms. Both HOTP and TOTP are based on existing and trusted cryptographic algorithms for verifying message integrity and uniqueness. Cryptography is a big topic, so I am limiting my explanations to those concepts that you need to know to understand the HOTP and TOTP algorithms.</p>
<p>The first concept that I want to teach you about is what we call a <strong>hash</strong>. Let&rsquo;s say that we have a message that we call $ M $. The message can be anything. It could be a string containing your name. It could be a JSON blob. It could be a file. It can be anything that can be represented as a string of bytes or octets (8-bit values). Given a message $ M $, there are functions that we call <strong>hash functions</strong> that will use $ M $ to generate a unique hash value that we&rsquo;ll call $ H $:</p>
<p>$$ F(M) = H $$</p>
<p>The hash function $ F(M) $ is a <a href="https://en.wikipedia.org/wiki/Pure_function" target="_blank" rel="noopener noreffer">pure function</a>. When called with the same value of $ M $, it will produce the same value $ H $. $ F(M) $ does not alter $ M $ in any way.</p>
<p>The family of hash functions that we will use for HOTP and TOTP are what we call cryptographic hash functions. These functions have been engineered such that the probability of ever encountering two messages $ M_1 $ and $ M_2 $ is so improbably that it is unlikely to happen. When this happens, it is called a <strong>collision</strong>. A collision is theoretically possible based on the size of the hash value $ H $ in bits. The SHA-1 function, for example, produces a hash value that is 160 bits in length, so there are $ 2^{160} $ possible values and an attack may need to throw that many messages at the hash function to find a collision.</p>
<p>Let&rsquo;s say that we have two users named Alice and Bob. Alice sends Bob a message. When Bob receives the message, how does Bob know that the message is correct? If the message came over the Internet, there could have been a bad router along the way that flipped a bit from 1 to 0 or 0 to 1. Then when Bob receives the message, the message he receives is corrupted and he will probably misread the message. Now let&rsquo;s say that Alice sends Bob both the message $ M $ and the hash value $ H $. Now if Bob and Alice both agree on the same hash function, Bob can generate a hash value from the message using $ F(M) = H' $. If $ H $ does not equal $ H` $, then Bob knows that he did not receive the message correctly. If $ H $ equals $ H' $, then Bob knows that the message was transmitted correctly.</p>
<p>The next problem is how does Bob know that the message came from Alice? Bob can use the hash to verify that the message is correct. But Bob cannot verify the source. Another actor, Charlie, could use the same hash function that Alice and Bob are using and send a message to Bob while pretending to be Alice. How can Bob verify that the message $ M $ was sent from Alice to Bob?</p>
<p>To verify the message, we have two cryptographic options:</p>
<ul>
<li>Message authentication codes</li>
<li>Digital signatures</li>
</ul>
<p>We&rsquo;re going to focus on message authentication codes in this post. A message authentication code is generated by another function $ MAC(K, H) $ that takes a hash $ H $ and a secret $ K $ and generates a new hash value $ C $. Like the hash function, $ MAC(K, H) $ is a pure function and will only generate the code $ C $ using the same secret $ K $ and hash $ H $:</p>
<p>$$ MAC(K, H) = C $$</p>
<p>Now, back to Alice and Bob, if Alice sends Bob a message $ M $ and the message authentication code $ C $ instead of the hash $ H $, and if Bob and Alice agree on a secret $ K $, Bob can authenticate that the message came from Alice and not Charlie, assuming that Charlie does not know the secret that Alice and Bob are sharing. Bob can calculate the hash $ H $ of message $ M $, and then using the secret calculate the authentication code $ C $ using the message authentication code function $ MAC(K, H) $. If the authentication codes match, then the message is authentic and can be assumed to have originated from Alice. Remember that this works only if it can be guaranteed that the secret that Alice and Bob share is kept safe and never exposed to Charlie.</p>
<h2 id="hotp">HOTP</h2>
<p>HOTP is based on the <a href="https://en.wikipedia.org/wiki/HMAC" target="_blank" rel="noopener noreffer">HMAC</a> message authentication code algorithm. HMAC produces a message authentication code that is equal in length to the hash that is provided to it. HMAC also requires a shared secret value that is the same length as the hash.</p>
<p>HOTP works using an incrementing counter. Imagine that you are given a token that you can tap a button to generate a password. The first time that you tap the button, the internal counter is set to 0. The next time, the counter will be 1, then 2, and so on. There is no way to reset the token so that you can get the first password ever again. The secret is stored in your token and may also be stored on the server that you send your password to in order to authenticate. The server also keeps track of how many passwords you have entered, so its counter matches the token&rsquo;s counter.</p>
<p>With HOTP, we can define a function that outputs a unique password:</p>
<p>$$ HOTP(K, C) = P $$</p>
<p>$ K $ is the shared secret value. $ C $ is the current value of the incrementing counter. $ P $ is the generated password. In reality, there&rsquo;s two other parameters to the function that I will call $ D $:</p>
<p>$$ HOTP(H, K, C, D) = P $$</p>
<p>$ D $ is the desired length of $ P $. For example, it is common to see one time passwords that are six or eight digits in length. One time passwords are usually zero-padded on the left to ensure that the password is the desired length. $ H $ is a function of the form $ H(M) $ that is the hash function that is used to generate the one time password. For HOTP, $ C $ is a 64-bit unsigned integer value and typically starts at 0.</p>
<p>HOTP will begin by using the counter $ C $ to generate the hash using the hash function $ H $:</p>
<p>$$ H(C) = H' $$</p>
<p>The output $ H` $ is a sequence of bytes or octets (8 bits) that are the hash of the counter $ C $. For example, if $ H(C) $ implements the <a href="https://en.wikipedia.org/wiki/SHA-1" target="_blank" rel="noopener noreffer">SHA-1</a> algorithm, then $ H' $ will be 160 bits (20 bytes) in length. We then calculate the message authentication code $ A $ using the HMAC algorithm:</p>
<p>$$ HMAC(K, H') = A $$</p>
<p>The next step is to truncate $ A $ and produce the one time password. The first thing that we will do is to look at the last 4 bits of $ A $. The last 4 bits will give us an offset between 0 and 15 into $ A $ that we will use to extract out a 32-bit signed non-negative integer (it is guaranteed to be non-negative because we only use the lower 31 bits of the extracted value, so the sign bit will always be 0).</p>
<p>Finally, we can calculate the one time password to the specified number of digits (assume $ V $ is the 32-bit positive integer that we just extracted from the hash):</p>
<p>$$ P = V mod 10^D $$</p>
<p>The result is that we will have a code that is $ D $ digits in length or less (which we will need to zero-pad).</p>
<p>How does this look in code? Fortunately, this is fairly easy. I have implemented the algorithm below using Go:</p>
<div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw"></i>Pay Attention to Byte Order<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">It is important to note that HOTP assumes that binary values are stored in <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreffer">big endian</a> form. Most modern processors store binary values in little endian form, so it is important if you are translating this algorithm to another language or implementation to ensure that you operate on the bytes in the correct order and translate when necessary.</div>
        </div>
    </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">hotp</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;crypto/hmac&#34;</span>
    <span class="s">&#34;encoding/binary&#34;</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;hash&#34;</span>
    <span class="s">&#34;math&#34;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">HOTP</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">hash</span>   <span class="kd">func</span><span class="p">()</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">Hash</span>
    <span class="nx">secret</span> <span class="p">[]</span><span class="kt">byte</span>
    <span class="nx">digits</span> <span class="kt">int</span>
    <span class="nx">format</span> <span class="kt">string</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">New</span><span class="p">(</span><span class="nx">hash</span> <span class="kd">func</span><span class="p">()</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">Hash</span><span class="p">,</span> <span class="nx">secret</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">digits</span> <span class="kt">int</span><span class="p">)</span> <span class="nx">HOTP</span> <span class="p">{</span>
    <span class="nx">format</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%%0%dd&#34;</span><span class="p">,</span> <span class="nx">digits</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">HOTP</span><span class="p">{</span>
        <span class="nx">hash</span><span class="p">:</span> <span class="nx">hash</span><span class="p">,</span>
        <span class="nx">secret</span><span class="p">:</span> <span class="nx">secret</span><span class="p">,</span>
        <span class="nx">digits</span><span class="p">:</span> <span class="nx">digits</span><span class="p">,</span>
        <span class="nx">format</span><span class="p">:</span> <span class="nx">format</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HOTP</span><span class="p">)</span> <span class="nf">Password</span><span class="p">(</span><span class="nx">counter</span> <span class="kt">uint64</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="c1">// Convert counter to a byte array
</span><span class="c1"></span>
    <span class="nx">counterBytes</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="nx">binary</span><span class="p">.</span><span class="nx">BinEngian</span><span class="p">.</span><span class="nf">PutUint64</span><span class="p">(</span><span class="nx">counterBytes</span><span class="p">,</span> <span class="nx">counter</span><span class="p">)</span>

    <span class="c1">// Calculate the HMAC of the hash
</span><span class="c1"></span>
    <span class="nx">hmac</span> <span class="o">:=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">hash</span><span class="p">,</span> <span class="nx">h</span><span class="p">.</span><span class="nx">secret</span><span class="p">)</span>
    <span class="nx">hmac</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="nx">counterBytes</span><span class="p">)</span>
    <span class="nx">hash</span> <span class="o">:=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nf">Sum</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>

    <span class="c1">// Truncate the authentication code. Get the offset from the lower 4 bits
</span><span class="c1"></span>    <span class="c1">// of the authentication code.
</span><span class="c1"></span>    <span class="nx">offset</span> <span class="o">:=</span> <span class="nx">hash</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nx">hash</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xf</span>

    <span class="c1">// Use the offset to read a 32-bit positive integer. The sign bit is
</span><span class="c1"></span>    <span class="c1">// excluded using the mask to ensure that num is a positive integer.
</span><span class="c1"></span>
    <span class="nx">p</span> <span class="o">:=</span> <span class="nx">hash</span><span class="p">[</span><span class="nx">offset</span><span class="p">:</span><span class="nx">offset</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
    <span class="nx">num</span> <span class="o">:=</span> <span class="nx">binary</span><span class="p">.</span><span class="nx">BigEndian</span><span class="p">.</span><span class="nf">Uint32</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7fffffff</span>

    <span class="c1">// Generate the one time passcode and zero-pad it if necessary
</span><span class="c1"></span>
    <span class="nx">d</span> <span class="o">:=</span> <span class="nb">uint64</span><span class="p">(</span><span class="nx">math</span><span class="p">.</span><span class="nf">Mod</span><span class="p">(</span><span class="nb">float64</span><span class="p">(</span><span class="nx">num</span><span class="p">),</span> <span class="nx">math</span><span class="p">.</span><span class="nf">Pow10</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">digits</span><span class="p">)))</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">format</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<p>Appendix D of the RFC includes test outputs for the HOTP algorithm when using the string <code>&quot;12345678901234567890&quot;</code> as the secret value. Using the previous implementation, I should see the following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">secret</span> <span class="o">:=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;12345678901234567890&#34;</span><span class="p">)</span>
<span class="nx">hotp</span> <span class="o">:=</span> <span class="nx">hotp</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="nx">sha1</span><span class="p">.</span><span class="nx">New</span><span class="p">,</span> <span class="nx">secret</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">// 755224
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// 287082
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">// 359152
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">// 969429
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1">// 338314
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1">// 254676
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="c1">// 287922
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c1">// 162583
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="c1">// 399871
</span><span class="c1"></span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="c1">// 520489
</span></code></pre></td></tr></table>
</div>
</div>
<p>We have succeeded in generating one time passwords!</p>
<p>If you have been following along, you might have identified a problem with the HOTP algorithm. What happens if our password token and the server get out of sync? What happens if the server is offline and we request a password? The next time we try to log in, the server&rsquo;s counter is one less than the token&rsquo;s. to fix this, you will need to come up with some sort of resynchronization capability between your token and server. TOTP gets around this by using time as the counter.</p>
<h2 id="totp">TOTP</h2>
<p>TOTP builds on top of HOTP and actually uses HOTP. But instead of using an incrementing counter, TOTP uses time, or more specifically, time buckets to generate a password that is unique and valid within a specific time period.</p>
<p>TOTP introduces two new values. $ T_0 $ is what we call the start time. This is a time that both parties agree to. Time for TOTP is specified as the number of seconds since $ T_0 $. The next value we&rsquo;ll call $ X $ and is the duration in seconds of what we will call a <strong>time step</strong>. Let us use 30 seconds for $ X $. This means that TOTP will generate the same password for seconds 0 through 29 of the same minute. When the number of seconds changes to 30, TOTP will give us a new password.</p>
<p>$ T_0 $ can be any time, but the time that is typically used is a value known as the <a href="https://en.wikipedia.org/wiki/Unix_time" target="_blank" rel="noopener noreffer">Unix epoch</a> which is defined as midnight UTC time on January 1, 1970. To calculate the counter value that is passed to HOTP, TOTP calculates the number of seconds between the current time and $ T_0 $, and then divides that result by the time step duration $ X $ to determine which time step is active. That time step now becomes the counter that is passed to HOTP. If the Unix epoch is not used, then $ T_0 $ is the number of seconds since midnight UTC time on January 1, 1970. Otherwise $ T_0 $ will be 0 to equal the Unix epoch.</p>
<p>Using $ T $ for the current time, we can define the TOTP algorithm:</p>
<p>$$ C = \frac{T - T_0}{X} \newline P = TOTP(H, K, C, D) $$</p>
<p>This can be coded easily in Go:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">totp</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;hash&#34;</span>
    <span class="s">&#34;time&#34;</span>

    <span class="s">&#34;github.com/mfcollins3/hotp&#34;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">TOTP</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">hotp</span>      <span class="nx">hotp</span><span class="p">.</span><span class="nx">HOTP</span>
    <span class="nx">startTime</span> <span class="kt">uint64</span>
    <span class="nx">timestep</span>  <span class="kt">uint64</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">New</span><span class="p">(</span>
    <span class="nx">hash</span> <span class="kd">func</span><span class="p">()</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">Hash</span><span class="p">,</span>
    <span class="nx">secret</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span>
    <span class="nx">digits</span> <span class="kt">int</span><span class="p">,</span>
    <span class="nx">startTime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">,</span>
    <span class="nx">timeStep</span> <span class="kt">int</span>
<span class="p">)</span> <span class="nx">TOTP</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">TOTP</span><span class="p">{</span>
        <span class="nx">hotp</span><span class="p">:</span>      <span class="nx">hotp</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="nx">hash</span><span class="p">,</span> <span class="nx">secret</span><span class="p">,</span> <span class="nx">digits</span><span class="p">),</span>
        <span class="nx">startTime</span><span class="p">:</span> <span class="nb">uint64</span><span class="p">(</span><span class="nx">startTime</span><span class="p">.</span><span class="nf">Unix</span><span class="p">()),</span>
        <span class="nx">timeStep</span><span class="p">:</span>  <span class="nb">uint64</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="nx">TOTP</span><span class="p">)</span> <span class="nf">Password</span><span class="p">(</span><span class="nx">time</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="nx">unixTime</span> <span class="o">:=</span> <span class="nb">uint64</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">())</span>
    <span class="nx">counter</span> <span class="o">:=</span> <span class="p">(</span><span class="nx">unixTime</span> <span class="o">-</span> <span class="nx">t</span><span class="p">.</span><span class="nx">startTime</span><span class="p">)</span> <span class="o">/</span> <span class="nx">t</span><span class="p">.</span><span class="nx">timeStep</span>
    <span class="k">return</span> <span class="nx">t</span><span class="p">.</span><span class="nx">hotp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">counter</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<p>I can test this out using the test values in the TOTP specification:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">epoch</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">// SHA-1 (20-byte secret)
</span><span class="c1"></span>
<span class="nx">secret</span> <span class="o">:=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;12345678901234567890&#34;</span><span class="p">)</span>
<span class="nx">totp</span> <span class="o">:=</span> <span class="nx">totp</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="nx">sha1</span><span class="p">.</span><span class="nx">New</span><span class="p">,</span> <span class="nx">secret</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="nx">epoch</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 46119246
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1111111109</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 68084774
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1111111111</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 67062674
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1234567890</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 91819424
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">2000000000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 90698825
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">20000000000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 77737706
</span><span class="c1"></span>
<span class="c1">// SHA-256 (32-byte secret)
</span><span class="c1"></span>
<span class="nx">secret</span> <span class="o">:=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;12345678901234567890123456789012&#34;</span><span class="p">)</span>
<span class="nx">totp</span> <span class="p">=</span> <span class="nx">totp</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="nx">sha256</span><span class="p">.</span><span class="nx">New</span><span class="p">,</span> <span class="nx">secret</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="nx">epoch</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 46119246
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1111111109</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 68084774
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1111111111</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 67062674
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1234567890</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 91819424
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">2000000000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 90698825
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">20000000000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 77737706
</span><span class="c1"></span>
<span class="c1">// SHA-512 (64-byte secret)
</span><span class="c1"></span>
<span class="nx">secret</span> <span class="o">:=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;1234567890123456789012345678901234567890123456789012345678901234&#34;</span><span class="p">)</span>
<span class="nx">totp</span> <span class="p">=</span> <span class="nx">totp</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="nx">sha256</span><span class="p">.</span><span class="nx">New</span><span class="p">,</span> <span class="nx">secret</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="nx">epoch</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 90693936
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1111111109</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 25091201
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1111111111</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 99943326
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">1234567890</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 93441116
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">2000000000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 38618901
</span><span class="c1"></span><span class="nx">totp</span><span class="p">.</span><span class="nf">Password</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="mi">20000000000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">// 47863826
</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="summary">Summary</h2>
<p>In this post, I intended to explain to you how those new-fangled passcodes that you receive in texts or emails are generated. I wanted to explain the algorithms to you and how they work so that you can implement support for them in your own applications.</p>


<span>Photo by <a href="https://unsplash.com/@razvan_mirel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Razvan Mirel</a> on <a href="https://unsplash.com/s/photos/lock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span></div><div class="post-info-share">
    <span><a class="share-icon share-twitter" href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/" data-title="All About One Time Passwords" data-via="mfcollins3" data-hashtags="HOTP,Password,TOTP"><i class="fab fa-twitter fa-fw"></i></a><a class="share-icon share-facebook" href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/" data-hashtag="HOTP"><i class="fab fa-facebook-square fa-fw"></i></a><a class="share-icon share-linkedin" href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/"><i class="fab fa-linkedin fa-fw"></i></a><a class="share-icon share-pinterest" href="javascript:void(0);" title="Share on Pinterest" data-sharer="pinterest" data-url="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/" data-description="In this post, I will tell you all that you need to know about how those one time passwords that you receive in texts, emails, or authentication programs work."><i class="fab fa-pinterest fa-fw"></i></a><a class="share-icon share-reddit" href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://www.michaelfcollins3.me/posts/2021/01/all-about-one-time-passwords/"><i class="fab fa-reddit fa-fw"></i></a></span>
</div>
<div class="footer-post-author"style="border-radius: 10px;border-bottom: solid 2px #ececec">
    <div class="author-avatar"><a href="https://www.michaelfcollins3.me" target="_blank"><img alt="" src="" border="0"></a></div>
    <div class="author-info">
        <div class="name"><a href="https://www.michaelfcollins3.me" target="_blank">Michael F. Collins, III</a></div>
        <div class="number-posts">Michael Collins is a software developer with 27 years of professional software development experience. Michael is a Technical Client Director in the Digital Platforms practice at Neudesic, and proudly serves the Desert Mountain region (Arizona, Nevada, and Colorado) from our office in Tempe, Arizona. Michael is very passionnate about software development and loves creating custom applications for himself and his customers. When not developing software, Michael is an avid Disney fan, enjoys reading, baking, cooking, Legos, and learning new things. Michael lives in Surprise, Arizona, with his wife and three children.</span></div>
    </div>
</div><div class="post-footer" id="post-footer"><div class="post-navigation"><div class="post-nav-box nav-box-prev">
            <a class="nav-box" href="/posts/2021/01/build-libgit2-for-ios-and-catalyst/"><span class="nav-icon"><svg aria-hidden="true" data-prefix="fas" data-icon="chevron-circle-left" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zM142.1 273l135.5 135.5c9.4 9.4 24.6 9.4 33.9 0l17-17c9.4-9.4 9.4-24.6 0-33.9L226.9 256l101.6-101.6c9.4-9.4 9.4-24.6 0-33.9l-17-17c-9.4-9.4-24.6-9.4-33.9 0L142.1 239c-9.4 9.4-9.4 24.6 0 34z"></path></svg></span><div style="text-align: right;padding-left: 10px"><div class="nav-text-h">Next article</div><span class="nav-text">Build libgit2 for iOS and Catalyst</span></div></a>
        </div></div></div>
</div>

    </article><div class=" post-tags post-tags-toc "><a href="/tags/hotp/" class="tag">HOTP</a><a href="/tags/password/" class="tag">Password</a><a href="/tags/totp/" class="tag">TOTP</a></div><div class=" page single comments page-toc "><div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></div></div></main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.80.0">Hugo</a> | Theme - <a href="https://github.com/upagge/uBlogger" target="_blank" rel="noopener noreffer" title="uBlogger 1.2.0"><i class="far fa-kiss-wink-heart fa-fw"></i> uBlogger</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span>2012 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://www.michaelfcollins3.me" target="_blank">Michael F. Collins, III</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.814eba54011def7fdeead06ae5cf964a245c347d0f4972e71cc3de1482b1b473.css" integrity="sha256-gU66VAEd73/e6tBq5c&#43;WSiRcNH0PSXLnHMPeFIKxtHM="><link rel="stylesheet" href="/lib/katex/katex.min.4710034e669c7ff17f823f9ba12cf8a36582d65b007f79cbc4a3c11d7db2e4ca.css" integrity="sha256-RxADTmacf/F/gj&#43;boSz4o2WC1lsAf3nLxKPBHX2y5Mo="><script src="https://mfcollins3.disqus.com/embed.js" defer></script><script src="/lib/smooth-scroll/smooth-scroll.min.bcff85fb5e00d68802850b393ac7792c997f722f536f38e26638c46dca8e5eb6.js" integrity="sha256-vP&#43;F&#43;14A1ogChQs5Osd5LJl/ci9TbzjiZjjEbcqOXrY="></script><script src="/lib/lazysizes/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js" integrity="sha256-&#43;2SfyuYhd9/mPmcIHdzrgwtc4fBaQYTpu7fYesS49OU="></script><script src="/lib/lightgallery/lightgallery.min.0ef47b3aa47d71accebfc4c7029c37f43d35f3ef43cda0e706c7adb8851f9554.js" integrity="sha256-DvR7OqR9cazOv8THApw39D018&#43;9DzaDnBsetuIUflVQ="></script><script src="/lib/lightgallery/lg-thumbnail.min.87bd0bf4ede9af1be2287acf1f0ac8777dc76a49209d44620752811c3c993897.js" integrity="sha256-h70L9O3prxviKHrPHwrId33HakkgnURiB1KBHDyZOJc="></script><script src="/lib/lightgallery/lg-zoom.min.5993efde07d6b1a88dd5d5ff00cf5c0178d1d8c7f682eae59546a8e144aac57e.js" integrity="sha256-WZPv3gfWsaiN1dX/AM9cAXjR2Mf2gurllUao4USqxX4="></script><script src="/lib/clipboard/clipboard.min.8a7739925f4c03586479852df840b7061948832a7fda30c8c812d2ea4dd4c4f2.js" integrity="sha256-inc5kl9MA1hkeYUt&#43;EC3BhlIgyp/2jDIyBLS6k3UxPI="></script><script src="/lib/sharer/sharer.min.9c88f86c7f0820287113f6236200459832693656e80d7556cc80a93dfbd45813.js" integrity="sha256-nIj4bH8IIChxE/YjYgBFmDJpNlboDXVWzICpPfvUWBM="></script><script src="/lib/katex/katex.min.17f5dd6b9f123dd7140abfb18521b3f4c036cd004f6f40121182a8865f140877.js" integrity="sha256-F/Xda58SPdcUCr&#43;xhSGz9MA2zQBPb0ASEYKohl8UCHc="></script><script src="/lib/katex/auto-render.min.f74776a677f0d2be0af0264058f928e2ba455d0b19bc985304660d922a43a6b2.js" integrity="sha256-90d2pnfw0r4K8CZAWPko4rpFXQsZvJhTBGYNkipDprI="></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script src="/js/theme.min.e81b8b64413300ad46847cc23b0399579c0b4462ecc55bd8b4c6f0c0f1239f40.js" integrity="sha256-6BuLZEEzAK1GhHzCOwOZV5wLRGLsxVvYtMbwwPEjn0A="></script><script src="/js/jquery-3.5.1.min.f7f6a5894f1d19ddad6fa392b2ece2c5e578cbf7da4ea805b6885eb6985b6e3d.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="></script><script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	        ga('create', 'UA-62548623-1', 'auto');
	        
	        ga('send', 'pageview');
	    </script></body>
</html>
